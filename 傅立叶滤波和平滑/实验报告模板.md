# 傅立叶滤波和平滑 - 实验报告

## 1. 实验目的

本实验旨在通过对道琼斯工业平均指数数据进行傅立叶变换和滤波处理，达到以下目标：
- 掌握傅立叶变换在金融时间序列分析中的应用
- 理解不同频率成分对信号的影响
- 学习通过频域滤波提取信号特征的方法
- 分析滤波参数变化对结果的影响

## 2. 方法简述

请简要描述您实现的算法和方法，特别是：
- 数据加载和预处理的方法
- 傅立叶变换和逆变换的实现
- 滤波器的设计原理（保留前10%和前2%系数的实现）
- 可视化方法的选择

_在此处填写您的方法描述（约200-300字）_
在本实验中，数据加载环节使用`np.loadtxt`从指定路径读取`dow.txt`数据，转化为`numpy`数组，加载失败时会捕获异常并提示错误，未进行复杂预处理。傅立叶变换借助`np.fft.rfft`获取频域系数，逆变换通过`np.fft.irfft`将处理后的频域系数转回时域，`n`设为原始数据长度保证维度一致。滤波器设计在`fourier_filter`函数中完成，依据设定的保留系数比例（如0.1、0.02 ）算出保留数量`cutoff`，将其余高频系数置0来实现滤波，改变比例可观察频率成分对信号的影响。可视化方面采用`matplotlib.pyplot` ，`plot_data`绘制原始数据序列图并添加标题等元素，`plot_comparison`在同一图中以不同颜色、线宽区分原始与滤波数据并加图例，直观展现滤波效果。 
## 3. 实验结果

### 3.1 原始数据时间序列

请在此处粘贴您生成的道琼斯工业平均指数原始数据时间序列图，并说明您从图中观察到的特征。

_在此处插入原始数据时间序列图像_
![image](https://github.com/user-attachments/assets/51ddbf63-a4ee-4a49-8e1a-b4e0b476e82f)


图像说明：
_在此处添加对图像的解释（约100字）_
这张图表展示的是道琼斯工业平均指数的原始数据情况。横坐标代表交易日，纵坐标为指数值。从图中可以看到，曲线走势波动频繁且幅度较大。在前期，指数呈现出一定的上升态势，随后进入一段震荡下跌区间，期间出现了明显的大幅下探。后期又逐渐回升，整体反映出在统计周期内，道琼斯工业平均指数受宏观经济、市场情绪等多种因素综合影响，呈现出复杂多变的波动特征。 
### 3.2 保留前10%系数的滤波结果

请在此处粘贴您生成的保留前10%傅立叶系数的滤波结果图像，并说明：
1. 滤波后信号与原始信号的差异
2. 被抑制的频率成分对信号的影响

_在此处插入10%滤波结果图像_
![image](https://github.com/user-attachments/assets/ce24b31c-2b49-4e1b-8c20-9ee366edf7ee)

图像说明：
_在此处添加对图像的解释（约100字）_
这张图中，滤波后信号（红线）与原始信号（绿线）相比，波动幅度显著减小，曲线更平滑。原始信号波动频繁、细节丰富，滤波后舍弃了部分细微变化。被抑制的高频成分如同信号中的“噪声”，去除它们有效减少了短期随机干扰，使指数长期趋势更突出。像400 - 600交易日的下跌与600 - 1000交易日的上升趋势，在滤波后信号中呈现得更为清晰，而原始信号受高频波动干扰，趋势展现相对模糊。 
### 3.3 保留前2%系数的滤波结果

请在此处粘贴您生成的保留前2%傅立叶系数的滤波结果图像，并说明：
1. 与10%滤波结果的对比
2. 更严格滤波对信号的影响

_在此处插入2%滤波结果图像_
![image](https://github.com/user-attachments/assets/ccae4460-521d-4190-b00c-da0dc1b5760d)

图像说明：
_在此处添加对图像的解释（约100字）_
与保留前10%系数的滤波结果相比，这张保留前2%系数的滤波图中，滤波后信号（红线）平滑程度显著提升。在保留前10%系数时，滤波后信号仍保留部分较小波动，而此次更严格滤波，几乎滤除了所有高频细微变化。

更严格滤波对信号影响明显。一方面，它极大地突出了长期趋势，像在市场下跌与回升阶段，趋势的连贯性和清晰度大幅增强，更便于观察整体走向。但另一方面，过度滤波也造成信息损失，许多短期波动细节被消除，而这些细节可能蕴含市场短期情绪和供需变化等信息，导致信号对市场短期动态反应能力下降，在分析市场短期变化时会有所局限。 
## 4. 分析与讨论

### 4.1 不同滤波参数的影响

请讨论：
- 保留10%系数与保留2%系数结果的差异
- 不同滤波强度对信号平滑程度的影响
- 过度滤波可能导致的问题

_在此处填写您的分析（约200字）_
保留10%系数与保留2%系数的滤波结果存在明显差异。保留10%系数时，滤波后信号仍保留一定高频成分，曲线有少量波动，能兼顾一定细节和趋势；而保留2%系数，高频成分被大幅抑制，信号更为平滑，趋势展现更纯粹。

滤波强度直接影响信号平滑程度，强度越高，平滑效果越显著。从保留10%到2%系数，信号高频波动逐步减少，平滑度递增。

但过度滤波会引发问题。如保留2%系数时，虽突出长期趋势，却丢失大量细节信息，市场短期波动和异常变化被掩盖，无法及时反映市场短期供需和情绪变化，在依赖短期信息进行决策的场景中，过度滤波的信号参考价值降低。 
### 4.2 金融时间序列的频率特征

讨论道琼斯指数中不同频率成分可能代表的经济现象：
- 低频成分（长期趋势）反映了什么经济因素？
- 高频成分（短期波动）通常由什么因素引起？

_在此处填写您的讨论（约200字）_
道琼斯指数中的低频成分，也就是长期趋势，主要反映宏观经济的基本面因素。从经济增长角度来看，长期的经济扩张或收缩，如美国GDP的持续增长或衰退，会推动道琼斯指数形成长期上升或下降趋势 。此外，产业结构的变迁也至关重要，像从传统工业向新兴科技产业转型的过程中，指数中的相关成分股表现会影响整体趋势。货币政策的长期导向，比如美联储持续的低利率或高利率政策，会影响企业的融资成本和投资者的资金流向，进而塑造指数的长期走势。

高频成分，即短期波动，通常由多种短期因素引起。突发的政治事件，如总统选举结果、贸易摩擦升级等，会在短期内影响市场情绪，引发指数的大幅波动。宏观经济数据的公布，如非农就业数据、CPI 数据等，若与市场预期不符，也会导致指数在短期内剧烈变动。此外，公司层面的重大消息，比如财报发布、新产品推出或重大诉讼等，也会使相关成分股股价短期波动，进而带动道琼斯指数的高频波动。 
### 4.3 思考题

1. 如果我们对道琼斯指数数据进行对数变换后再进行傅立叶分析，结果会有什么不同？

_在此处填写您的回答（约100字）_
对道琼斯指数数据进行对数变换后再做傅立叶分析，结果会有显著不同。对数变换能压缩数据范围，减少数据异方差性，让不同幅度的波动更具可比性。在傅立叶分析中，原本较大的价格波动在对数尺度下相对幅度减小，可能改变频率成分占比，使低频成分影响相对增强，高频成分的相对重要性可能降低。这会让滤波后信号更突出长期趋势，平滑效果在对数尺度下对趋势的刻画可能更符合经济逻辑和统计特性。 
2. 傅立叶变换假设信号是周期性的，但金融数据通常不是严格周期性的。这会导致什么问题？

_在此处填写您的回答（约100字）_

傅立叶变换基于信号周期性假设，而金融数据（如股价、指数）并非严格周期性，这会导致频谱泄漏和虚假周期等问题。非周期性信号截断后进行傅立叶变换时，能量会扩散到相邻频率，使频谱分析结果失真，难以准确识别真实频率成分。此外，金融数据的复杂波动可能被错误分解为不存在的周期性分量，导致对市场规律的误判，例如将随机噪声解读为某种周期模式，影响滤波和预测模型的可靠性，尤其在低频趋势分析中可能引入偏差。
## 5. 结论

总结本实验的主要发现和收获，包括：
- 傅立叶滤波在金融数据分析中的应用价值
- 不同滤波参数的选择经验
- 实验过程中遇到的挑战和解决方法

_在此处填写您的结论（约150字）_

本实验通过对道琼斯指数的分析发现，傅立叶滤波能有效分离金融数据的高低频成分，应用价值体现在可通过抑制高频噪声凸显长期趋势，辅助趋势判断。滤波参数选择上，保留10%系数可平衡细节与趋势，2%则强化平滑但损失细节，需根据分析目标（短期波动或长期趋势）灵活调整。实验挑战主要是数据加载路径问题和滤波效果可视化，通过固定文件路径、增加异常处理及优化图表配色与标签解决，加深了对频域分析在金融领域应用的理解。
## 核心代码片段

请粘贴您实现的关键函数代码（如滤波函数实现），并简要说明代码的核心思路。

```
def fourier_filter(data, keep_fraction=0.1):
    """执行傅立叶低通滤波，保留指定比例低频系数"""
    # 傅立叶变换到频域
    fft_coeff = np.fft.rfft(data)
    # 计算保留的低频系数数量
    cutoff = int(len(fft_coeff) * keep_fraction)
    # 复制系数数组用于修改
    filtered_coeff = fft_coeff.copy()
    # 截断高频成分（保留前cutoff个系数）
    filtered_coeff[cutoff:] = 0
    # 逆变换回时域
    filtered_data = np.fft.irfft(filtered_coeff, n=len(data))
    return filtered_data, fft_coeff
```

代码说明：
_在此处简要解释代码的实现思路（约100字）_
该代码通过傅立叶变换将时间序列转换到频域，按指定比例（如10%、2%）保留低频系数，丢弃高频成分，再通过逆变换转回时域实现滤波。利用`np.fft.rfft`获取频域系数，按比例计算截断点，将高频部分置零后用`np.fft.irfft`恢复信号，有效平滑数据并保留趋势特征。
