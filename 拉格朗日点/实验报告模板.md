# 拉格朗日点 - 实验报告

## 1. 实验目的简述

本实验旨在通过数值方法求解地球-月球系统中L1拉格朗日点的位置，具体目标包括：
- 理解拉格朗日点的物理意义及其在天体力学中的重要性
- 推导L1点位置满足的方程
- 实现并比较不同的数值求根方法（牛顿法、弦截法）
- 分析数值方法的收敛性和精度

## 2. 方法简述

请简要描述您实现的算法和方法，特别是：
- L1点位置方程的推导过程和物理意义
在共旋转坐标系中，L1点满足引力与离心力平衡：
\[
\frac{GM}{r^2} - \frac{Gm}{(R-r)^2} = \omega^2 r
\]
其中r为地心到L1点的距离。方程左边表示地球和月球的引力差，右边为离心力项。当三力平衡时，探测器可在该点保持相对静止。
- 牛顿法和弦截法的实现策略
  1. **牛顿法**：利用函数值和解析导数迭代求解
     - 迭代公式：$x_{n+1} = x_n - f(x_n)/f'(x_n)$
     - 导数计算：$f' = -2GM/r^3 - 2Gm/(R-r)^3 - \omega^2$

  2. **弦截法**：通过两点线性近似替代导数
     - 迭代公式：$x_{n+1} = x_n - f(x_n)\frac{x_n-x_{n-1}}{f(x_n)-f(x_{n-1})}$
- 初值或初始区间的选择依据
  - 牛顿法初值3.5e8 m（地月距离的90%）
  - 弦截法区间[3.2e8,3.7e8]（包含理论预测值）
  - 基于L1点应位于地月连线且靠近月球的物理判断


## 3. 实验结果

### 3.1 L1点位置方程可视化

请在此处粘贴您生成的L1点位置方程图像，并简要说明图中的零点位置及其物理意义。

![Figure_1](https://github.com/user-attachments/assets/0c9116b1-6852-4d6b-8117-4fd2e40ccbd0)


图像说明：
函数曲线在3.26×10⁸ m处穿过零点，对应L1点平衡位置。曲线在月球附近（R=3.844e8 m）呈现显著非线性特征，验证了数值求解的必要性。

### 3.2 数值求解结果

请列出使用不同方法求解L1点位置的结果：

| 求解方法 | L1点位置 (m) | 相对于地月距离的比例 | 迭代次数 | 是否收敛 |
|---------|------------|-------------------|---------|--------|
| 牛顿法   |3.26045164e+08|0.848192         |   5     |  是    |
| 弦截法   |3.26044996e+08|0.848192         |  5      |  是    |
| fsolve  |3.26045072e+08|0.848192         | -       | -      |

### 3.3 不同方法的结果比较

请计算不同方法之间的结果差异：

| 比较项 | 绝对差异 (m) | 相对差异 (%) |
|-------|------------|-------------|
| 牛顿法 vs 弦截法 |1.67623739e+02|0.00005141|
| 牛顿法 vs fsolve |9.24189367e+01|0.00002835|
| 弦截法 vs fsolve |7.52048020e+01|0.00002307|

## 4. 分析与讨论

### 4.1 L1点的物理意义

请分析L1点的物理意义及其在空间任务中的应用价值：
- L1点为什么能保持卫星相对于地球和月球静止？
探测器在此处的地月引力差恰好提供所需向心力，使其保持与地月系统同步旋转
- 在L1点放置卫星有什么实际应用？
   - 太阳观测：DSCOVR卫星在此监测太阳风
   - 中继通信：作为地月通信枢纽
   - 深空探测：前往其他行星的跳板


### 4.2 数值方法的比较

讨论牛顿法和弦截法在求解此问题时的优缺点：
- 收敛速度比较
  牛顿法5次迭代，弦截法5次
- 对初值/初始区间的敏感性
  牛顿法在r>3.8e8时发散，弦截法区间容错性更好
- 计算复杂度和实现难度
  牛顿法需导数推导，弦截法更易实现但收敛条件复杂



### 4.3 思考题

1. 如果将地球质量M增加，L1点的位置将如何变化？请给出物理解释。

    当地球质量M增大时，地球引力项GM/r²增强，平衡位置会向月球方向移动。具体表现为r值减小，L1点更靠近地球以维持新的力平衡。

2. 除了L1点外，地球-月球系统还有其他拉格朗日点（L2-L5）。这些点的位置如何确定？它们各自有什么特点？
   - **L2**：月球背面的平衡点，用于深空观测（如鹊桥中继卫星）
   - **L3**：地球背面的不稳定点，实际应用较少
   - **L4/L5**：位于地月轨道60°前后的稳定三角点，可捕获天然天体
    确定方法：需建立三维运动方程，考虑科里奥利力等效应


_

## 5. 结论

总结本实验的主要发现和收获，包括对拉格朗日点物理意义的理解以及数值方法在天体力学问题中的应用。

    本实验成功计算出地月系统L1点位于距地球3.2638×10⁸ m处，占地月距离的84.89%。通过对比发现：
    1. 弦截法收敛速度优于牛顿法，但数值稳定性稍差
    2. 不同方法结果差异<1e-4%，验证了算法正确性
    3. L1点的特殊动力学特性使其具有重要航天应用价值
    实验加深了对天体力学数值模拟方法的理解，展现了科学计算在空间探索中的关键作用。

## 核心代码片段

请粘贴您实现的关键函数代码（如L1点位置方程和牛顿法实现），并简要说明代码的核心思路。

```python
def lagrange_equation(r):
    equation_value = (G*M)/(r**2) - (G*m)/((R - r)**2) - (omega**2)*r
    return equation_value


def lagrange_equation_derivative(r):
    derivative_value = -2*G*M/(r**3) - 2*(G*m)/((R - r)**3) - omega**2
    return derivative_value


def newton_method(f, df, x0, tol=1e-8, max_iter=100):
    x = x0
    iterations = 0
    converged = False
    for i in range(max_iter):
        if abs(f(x)) < tol:      #如果f(x)=0,结束循环
            iterations = i + 1
            converged = True
            break
        if abs(df(x)) < 1e-14:     #分母不能为零
            break
        x1 = x -f(x)/df(x)
        x = x1
        iterations = i + 1
    return x, iterations, converged


def secant_method(f, a, b, tol=1e-8, max_iter=100):
    if abs(f(a)) < tol:
        return a, 0, True
    if abs(f(b)) < tol:
        return b, 0, True
    iterations = 0
    converged = False
    x1,x2 = a,b
    f1,f2 = f(a),f(b)
    for i in range(max_iter):
        if abs(f1 - f2) < tol:   #除数不能为零
            break
        x3 = x2 -f2*(x2 - x1)/(f2 - f1)
        f3 = f(x3)
        if abs(f3) < tol:
            iterations = i + 1
            converged = True
            x2 = x3
            break
        x1,x2 = x2,x3
        f1,f2 = f2,f3
        iterations = i + 1
    return x2, iterations, converged
```

代码说明：
程序采用模块化设计，包含：
1. `lagrange_equation()`实现平衡方程
2. `newton_method()`和`secant_method()`实现数值求解器
3. `plot_lagrange_equation()`进行可视化分析_
